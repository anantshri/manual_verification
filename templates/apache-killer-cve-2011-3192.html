<!DOCTYPE html>
<html lang="en-us">
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <title>
    Apache Killer  HTTP.sys Remote Code Execution Vulnerability &middot; 
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="//anantshri.github.io/manual_verification/assets/css/bootstrap.min.css">

</head>

  <body>
      <nav class="navbar navbar-default">
        <div class="container-fluid">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="//anantshri.github.io/manual_verification">Manual Verification Templates</a>
          </div>
        </div>
      </nav>

  <div class="container">
<ul class="breadcrumb">
  <li><a href="//anantshri.github.io/manual_verification">Home</a></li>
  <li><a href="//anantshri.github.io/manual_verification/templates/">Templates</a></li>
  <li class="active">Apache Killer  HTTP.sys Remote Code Execution Vulnerability</li>
</ul>

<div class="bs-component">
  <div class="panel panel-primary">
    <div class="panel-heading">
      <h3 class="panel-title">Apache Killer  HTTP.sys Remote Code Execution Vulnerability</h3>
    </div>
    <div class="panel-body" markdown="1">
<h2 id="cve-2011-3192">CVE 2011-3192</h2>
<p>A denial of service vulnerability has been found in the way the multiple
overlapping ranges are handled by the Apache HTTPD server prior to version
2.2.20:</p>

<pre><code> http://seclists.org/fulldisclosure/2011/Aug/175
</code></pre>

<p>An attack tool is circulating in the wild. Active use of this tool has
been observed.</p>

<p>In addition to the ‘Range’ header - the ‘Request-Range’ header is equally
affected. Furthermore various vendor updates, improved regexes (speed and
accommodating a different and new attack pattern).</p>

<h2 id="affected-systems">Affected Systems</h2>

<p>All versions of Apache prior to version 2.2.20</p>

<h2 id="manual-verification-tests">Manual Verification Tests</h2>

<ul>
  <li>Command to be used</li>
</ul>

<p><code>
curl http://&lt;IP&gt;/ -H "Host: &lt;hostname&gt;" -H "Range: bytes=5-0,1-1,2-2,3-3,4-4,5-5,6-6,7-7,8-8,9-9,10-10" -w "%{http_code}" -o /dev/null -s
</code></p>

<p>OR</p>

<p><code>
curl http://&lt;IP&gt;/ -H "Host: &lt;hostname&gt;" -H "Request-Range: bytes=5-0,1-1,2-2,3-3,4-4,5-5,6-6,7-7,8-8,9-9,10-10" -w "%{http_code}" -o /dev/null -s
</code></p>

<ul>
  <li>Result Expected</li>
</ul>

<p><strong>Test Fail</strong>: Machine Vulnerable : 206</p>

<p><strong>Test Pass</strong>: Machine Not Vulnerable : Any error or response other then 206</p>

<p>Note: Payload is a direct copy from MSF module</p>

    <div class="references">
      <h3>Vulnerability Identifications</h3>
      <div id="CVE">CVE : 2011-3192</div>
      <div id="NESSUS">NESSUS : 55976</div>
      <div id="BUGTrack">BUGTrack : 49303</div>
      <div id="OSVDB">OSVDB : </div>
      <h3>Reference Links</h3>
    <ul>  
      
      <li>https://httpd.apache.org/security/CVE-2011-3192.txt</li>
      
      <li>https://www.rapid7.com/db/vulnerabilities/apache-httpd-cve-2011-3192</li>
      
      <li>https://www.rapid7.com/db/modules/auxiliary/dos/http/apache_range_dos</li>
      
      <li>https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/dos/http/apache_range_dos.rb</li>
      
    </ul>
    </div>
</div>
</div>
</div>
  </div>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/bootstrap/3.3.2/js/bootstrap.min.js"></script>
  <!-- 
This will hold some kind of analytics code
-->

  </body>
</html>
